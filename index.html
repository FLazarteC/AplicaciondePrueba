<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-auth-compat.js"></script>
    <script src="firebase.js"></script> <!-- Este es el archivo donde inicializas Firebase -->
</head>
<body>
    <button id="login">Iniciar sesión con Google</button>
    <button id="logout" style="display: none;">Cerrar sesión</button>
    <button id="goToMenu" style="display: none;" onclick="window.location.href='menu_principal.html'">Ir al Menú Principal</button> <!-- Botón que aparecerá solo cuando inicie sesión -->
    <br>
    <p id="username"></p>
    <img src="" alt="" id="user-img">

    <script>
        // Comprobamos si el usuario está autenticado
        firebase.auth().onAuthStateChanged(user => {
            const loginButton = document.getElementById("login");
            const logoutButton = document.getElementById("logout");
            const goToMenuButton = document.getElementById("goToMenu");
            const username = document.getElementById("username");
            const userImg = document.getElementById("user-img");

            if (user) {
                // Si el usuario está autenticado
                loginButton.style.display = "none";
                logoutButton.style.display = "inline-block";
                goToMenuButton.style.display = "inline-block";
                username.textContent = `Hola, ${user.displayName}`;
                userImg.src = user.photoURL;
            } else {
                // Si el usuario no está autenticado
                loginButton.style.display = "inline-block";
                logoutButton.style.display = "none";
                goToMenuButton.style.display = "none";
                username.textContent = "";
                userImg.src = "";
            }
        });

        // Iniciar sesión con Google
        document.getElementById("login").addEventListener("click", () => {
            const provider = new firebase.auth.GoogleAuthProvider();
            firebase.auth().signInWithPopup(provider).then(result => {
                const user = result.user;
                console.log(user);
            }).catch(error => {
                console.error("Error al iniciar sesión", error);
            });
        });

        // Cerrar sesión
        document.getElementById("logout").addEventListener("click", () => {
            firebase.auth().signOut().then(() => {
                console.log("Sesión cerrada");
            }).catch(error => {
                console.error("Error al cerrar sesión", error);
            });
        });
    </script>
</body>
</html>